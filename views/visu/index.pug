extends ../layout

block content
  link(rel='stylesheet', href='/stylesheets/visu.css')
  h1 Research Overview

  h2 Sources:
  .well#sources
    each source in sources
      button.src.btn.btn-info(id=source._id title='"'+source.title+'" by '+source.authors
        onmouseenter='showLinking("src","'+source._id+'", true);' 
        onmouseleave='showLinking("src","'+source._id+'", false);')
        =source.title

  h2 Source Retrieval Efforts (SREs):
  .well#sres
    each sre in sres
      button.sre.btn.btn-primary(id=sre._id title='['+sre.keywords+'] in ['+sre.platforms+']'
        onmouseenter='showLinking("sre","'+sre._id+'", true);' 
        onmouseleave='showLinking("sre","'+sre._id+'", false);')
        =sre.keywords

  h2 Query-, Process- & Result-Items
  .table-responsive
    table.table
      tbody

        tr
          td.th-left Queries 
          each item in queries
            -var statusColor
            if (item.status == 'done')
              -statusColor = 'green'
            else if (item.status == 'active')
              -statusColor = 'yellow'
            else if (item.status == 'draft')
              -statusColor = 'orange'

            td
              .well.item(id=item._id style='border-color:'+statusColor+';'
                onmouseenter='showLinking("query","'+item._id+'", true);'
                onmouseleave='showLinking("query","'+item._id+'", false);')
                span.glyphicon.glyphicon-list
                span.glyphicon.glyphicon-transfer
                b
                  | Num. of Sources: 
                if (item.srcs !== undefined)
                  =item.srcs.length
                else
                  | 0
                p
                  i
                    =item.descr
                    
        tr
          td.th-left Processes
          each q in queries
            -var item = undefined
            each p in processes 
              if (p.prev_ptr == q._id)
                -item = p
            if (item !== undefined)
              // determine border color depending on status of item
              -var statusColor
              if (item.status == 'done')
                -statusColor = 'green'
              else if (item.status == 'active')
                -statusColor = 'yellow'
              else if (item.status == 'draft')
                -statusColor = 'orange'
              // fill td with content
              td
                .well.item(id=item._id style='border-color:'+statusColor+';'
                  onmouseenter='showLinking("process","'+item._id+'", true);'
                  onmouseleave='showLinking("process","'+item._id+'", false);')
                  span.glyphicon.glyphicon-list
                  span.glyphicon.glyphicon-transfer
                  b App. 
                  input(id=item._id+'-q-applicability' type='text' disabled)
                  b  Rel. 
                  input(id=item._id+'-q-relevance' type='text' disabled)
                  b  Hol. 
                  input(id=item._id+'-q-holism' type='text' disabled)
                  p
                    i
                      =item.proposition
            else
              td
              
        tr
          td.th-left Results
          each q in queries
            -var item = undefined
            each p in processes 
              if (p.prev_ptr == q._id)
                each r in results
                  if(r.prev_ptr == p._id)
                    -item = r
            if (item !== undefined)
              // determine border color depending on status of item
              -var statusColor
              if (item.status == 'done')
                -statusColor = 'green'
              else if (item.status == 'active')
                -statusColor = 'yellow'
              else if (item.status == 'draft')
                -statusColor = 'orange'
              // fill td with content
              td
                .well.item(id=item._id style='border-color:'+statusColor+';'
                  onmouseenter='showLinking("result","'+item._id+'", true);'
                  onmouseleave='showLinking("result","'+item._id+'", false);')
                  span.glyphicon.glyphicon-list
                  span.glyphicon.glyphicon-transfer
                  b Eff. 
                  input(id=item._id+'-q-researchEffort' type='text' disabled)
                  b  Nov. 
                  input(id=item._id+'-q-novelty' type='text' disabled)
                  b  QoR 
                  input(id=item._id+'-q-qor' type='text' disabled)
                  p
                    i
                      =item.tldr
            else
              td

  script(src="/scripts/visuIndex.js")